function d(e){e.directive("intersect",e.skipDuringClone((r,{value:n,expression:s,modifiers:t},{evaluateLater:i,cleanup:l})=>{let u=i(s),f={rootMargin:y(t),threshold:m(t)},o=new IntersectionObserver(h=>{h.forEach(g=>{g.isIntersecting!==(n==="leave")&&(u(),t.includes("once")&&o.disconnect())})},f);o.observe(r),l(()=>{o.disconnect()})}))}function m(e){if(e.includes("full"))return .99;if(e.includes("half"))return .5;if(!e.includes("threshold"))return 0;let r=e[e.indexOf("threshold")+1];return r==="100"?1:r==="0"?0:+`.${r}`}function p(e){let r=e.match(/^(-?[0-9]+)(px|%)?$/);return r?r[1]+(r[2]||"px"):void 0}function y(e){const r="margin",n="0px 0px 0px 0px",s=e.indexOf(r);if(s===-1)return n;let t=[];for(let i=1;i<5;i++)t.push(p(e[s+i]||""));return t=t.filter(i=>i!==void 0),t.length?t.join(" ").trim():n}var a=d;function c(){return typeof Alpine>"u"?!1:(Alpine.data("contactForm",()=>({formData:{},errors:{},formError:"",submitted:!1,submitting:!1,config:null,submitUrl:"",successMessage:"",signature:"",pageUrl:"",init(){const e=this.$el.dataset.contactFormConfig;if(!e){console.error("Contact form missing data-contact-form-config attribute");return}try{this.config=JSON.parse(e)}catch(r){console.error("Failed to parse contact form config:",r);return}this.submitUrl=this.config.submitUrl||"",this.successMessage=this.config.successMessage||"Thank you for your message!",this.signature=this.config.signature||"",this.pageUrl=this.config.pageUrl||"",this.formData=(this.config.fieldNames||[]).reduce((r,n)=>({...r,[n]:""}),{_honeypot:""})},async submit(){this.submitting=!0,this.errors={},this.formError="";const e=document.querySelector("meta[name=csrf-token]");if(!e){this.formError="Security token missing. Please refresh the page.",this.submitting=!1;return}try{const r=await fetch(this.submitUrl,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e.content,Accept:"application/json"},body:JSON.stringify({...this.formData,_config:this.config.config,_signature:this.signature,_pageUrl:this.pageUrl})}),n=r.headers.get("content-type");if(!n||!n.includes("application/json")){console.error("Non-JSON response received:",r.status),this.formError="Server returned an unexpected response. Please try again.";return}let s;try{s=await r.json()}catch(t){console.error("Failed to parse JSON response:",t),this.formError="Server returned an invalid response. Please try again.";return}r.ok?this.submitted=!0:r.status===422?this.errors=s.errors||{}:r.status===429?this.formError=s.message||"Too many submissions. Please try again later.":r.status===400?this.formError=s.message||"Invalid request. Please refresh the page and try again.":this.formError=s.message||"An error occurred. Please try again."}catch(r){console.error("Contact form submission error:",r),this.formError="A network error occurred. Please check your connection and try again."}finally{this.submitting=!1}},getFieldError(e){return this.errors[e]?this.errors[e][0]:""},hasFieldError(e){return!!this.errors[e]}})),!0)}c()||document.addEventListener("alpine:init",c);window.Alpine?window.Alpine.plugin(a):(window.__tallcmsPlugins=window.__tallcmsPlugins||[],window.__tallcmsPlugins.push(a),document.addEventListener("alpine:init",()=>{(window.__tallcmsPlugins||[]).forEach(e=>{window.Alpine.plugin(e)}),window.__tallcmsPlugins=[]}));
